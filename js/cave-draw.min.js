/*!
 * CaveDraw V1.0.3
 *
 * 有评论的地方，就有CaveDraw。Add a draw board to your comment form.
 *
 * Copyright(C) flatblowfish
 * Github: https: //github.com/flatblowfish
 * Website: https: //blog.maplesugar.top
 */
!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.CaveDraw=e():t.CaveDraw=e()}(self,(()=>(()=>{var t={477:(t,e,r)=>{var n=r(779);t.exports=function(t){"use strict";t=t||{};var e="",r=n.$each,o=t.bows75,i=(t.color,t.$index,n.$escape),a=t.bows50,c=t.bows25;return e+='<div class="cdraw">\n    <div class="cdraw-toolbar">\n        <div class="cdraw-open btn" title="打开画板">打开画板</div>\n        <input class="cdraw-line-width btn" title="线宽" min="1" max="20" value="1" type="range">\n        <div class="cdraw-line-color btn" title="颜色">\n            <div class="current" style="background-color: rgb(0, 0, 0);" data-color="rgba(0, 0, 0, 1)"></div>\n            <div class="rains">\n                <div class="bows">\n                    ',r(o,(function(t,r){e+='\n                    <div class="color" data-color="',e+=i(t),e+='" style="background-color: ',e+=i(t),e+='"></div>\n                    '})),e+='\n                </div>\n                <div class="bows">\n                    ',r(a,(function(t,r){e+='\n                    <div class="color" data-color="',e+=i(t),e+='" style="background-color: ',e+=i(t),e+='"></div>\n                    '})),e+='\n                </div>\n                <div class="bows">\n                    ',r(c,(function(t,r){e+='\n                    <div class="color" data-color="',e+=i(t),e+='" style="background-color: ',e+=i(t),e+='"></div>\n                    '})),e+='\n                </div>\n            </div>\n        </div>\n        <div class="cdraw-roll scroll">\n            <div class="cdraw-brush btn" title="画笔"></div>\n            <div class="cdraw-eraser btn" title="橡皮擦"></div>\n            <div class="cdraw-bucket btn" title="油漆桶"></div>\n            <div class="cdraw-clear btn" title="清屏"></div>\n            <div class="cdraw-undo btn" title="撤销"></div>\n            <div class="cdraw-redo btn" title="重做"></div>\n            <div class="cdraw-save btn" title="保存"></div>\n        </div>\n    </div>\n    <canvas class="cdraw-canvas">\n        <div><a href="https://github.com/flatblowfish/cave-draw" target="_blank">Cave Draw</a>Powered by <a\n                href="https://blog.maplesugar.top" target="_blank">枫糖</a></div>\n    </canvas>\n</div>\n'}},585:(t,e,r)=>{"use strict";
/*! art-template@runtime | https://github.com/aui/art-template */var n="undefined"!=typeof self?self:"undefined"!=typeof window?window:void 0!==r.g?r.g:{},o=Object.create(n),i=/["&'<>]/;function toString(t){return"string"!=typeof t&&(t=null==t?"":"function"==typeof t?toString(t.call(t)):JSON.stringify(t)),t}o.$escape=function(t){return function(t){var e=""+t,r=i.exec(e);if(!r)return t;var n="",o=void 0,a=void 0,c=void 0;for(o=r.index,a=0;o<e.length;o++){switch(e.charCodeAt(o)){case 34:c="&#34;";break;case 38:c="&#38;";break;case 39:c="&#39;";break;case 60:c="&#60;";break;case 62:c="&#62;";break;default:continue}a!==o&&(n+=e.substring(a,o)),a=o+1,n+=c}return a!==o?n+e.substring(a,o):n}(toString(t))},o.$each=function(t,e){if(Array.isArray(t))for(var r=0,n=t.length;r<n;r++)e(t[r],r);else for(var o in t)e(t[o],o)},t.exports=o},779:(t,e,r)=>{"use strict";t.exports=r(585)},653:(t,e,r)=>{"use strict";r.d(e,{Z:()=>C});var n=r(81),o=r.n(n),i=r(645),a=r.n(i),c=r(667),s=r.n(c),u=new URL(r(105),r.b),l=new URL(r(554),r.b),f=new URL(r(378),r.b),p=new URL(r(620),r.b),d=new URL(r(157),r.b),h=new URL(r(811),r.b),y=new URL(r(583),r.b),b=new URL(r(413),r.b),v=new URL(r(797),r.b),w=a()(o()),_=s()(u),m=s()(l),g=s()(f),B=s()(p),P=s()(d),O=s()(h),k=s()(y),x=s()(b),E=s()(v);w.push([t.id,".cdraw{position:relative;-webkit-user-select:none;-moz-user-select:none;user-select:none}.cdraw *{box-sizing:border-box;padding:0;margin:0}.cdraw .cdraw-toolbar{display:flex;position:relative;align-items:center;justify-content:left;width:100%;height:34px;margin-top:10px;background:#fff;border-radius:3px;box-shadow:0 1px 2px 0 rgba(32,33,36,.28)}.cdraw .cdraw-toolbar .btn{display:inline-block;width:34px;min-width:34px;height:34px;border:2px solid rgba(0,0,0,0);margin:0px 3px;cursor:pointer;border-radius:4px;background-size:20px 20px;background-position:center center;background-repeat:no-repeat;background-color:#fff;transition:all .2s linear}.cdraw .cdraw-toolbar .btn.active{border-color:#1398e6}.cdraw .cdraw-toolbar .cdraw-open{width:80px;min-width:80px;height:34px;margin-left:0;border:none;border-radius:4px;color:#fff;font-size:15px;text-align:center;line-height:34px;background-color:#b37ba4}@media(max-width: 786px){.cdraw .cdraw-toolbar .cdraw-open{min-width:40px;font-size:14px}}.cdraw .cdraw-toolbar .cdraw-open:hover{background-color:#49d0c0}.cdraw .cdraw-toolbar .cdraw-line-color{display:inline-block;position:relative}.cdraw .cdraw-toolbar .cdraw-line-color .current{cursor:pointer;display:inline-block;width:24px;min-width:24px;height:24px;margin:3px;box-shadow:0 1px 2px 0 rgba(32,33,36,.28)}.cdraw .cdraw-toolbar .cdraw-line-color .rains{position:absolute;display:inline-block;top:-70px;left:0;width:244px;height:64px;padding:4px;border-radius:3px;border:1px solid #fff;box-shadow:0 1px 2px 0 rgba(32,33,36,.28);z-index:999}.cdraw .cdraw-toolbar .cdraw-line-color .rains .bows{height:18px;display:flex;align-items:center;justify-content:left}.cdraw .cdraw-toolbar .cdraw-line-color .rains .bows .color{display:inline-block;width:18px;height:18px;cursor:pointer;transition:all .1s linear}.cdraw .cdraw-toolbar .cdraw-line-color .rains .bows .color:hover{transform:scale(1.25)}.cdraw .cdraw-toolbar .cdraw-line-width{outline:none !important;border:none !important;padding:0 !important}.cdraw .cdraw-toolbar .cdraw-line-width{display:inline-block;width:60px;min-width:60px;-webkit-appearance:none}.cdraw .cdraw-toolbar .cdraw-line-width::-webkit-slider-runnable-track{height:4px;border-radius:5px;background-color:#dbdbdb}.cdraw .cdraw-toolbar .cdraw-line-width::-webkit-slider-thumb{-webkit-appearance:none;width:12px;height:12px;margin-top:-4px;border-radius:50%;background:#ff4081;cursor:pointer}.cdraw .cdraw-toolbar .cdraw-line-width::-moz-range-track{height:4px;border-radius:5px;background-color:#dbdbdb}.cdraw .cdraw-toolbar .cdraw-line-width::-moz-range-thumb{width:12px;height:12px;border:none;border-radius:50%;background:#ff4081;cursor:pointer}.cdraw .cdraw-toolbar .cdraw-roll{display:flex;height:34px;width:100%;flex-direction:row;flex-wrap:nowrap;align-items:center;border:none;border-radius:5px;cursor:default;overflow-x:scroll;overflow-y:hidden;overflow:scroll hidden;scrollbar-width:none}.cdraw .cdraw-toolbar .cdraw-roll::-webkit-scrollbar{display:none}.cdraw .cdraw-toolbar .cdraw-roll.active{cursor:pointer}.cdraw .cdraw-toolbar .cdraw-roll.scroll{border-left:#c978b4 solid 4px;border-right:#c978b4 solid 4px}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-brush{background-image:url("+_+")}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-eraser{background-image:url("+m+")}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-bucket{background-image:url("+g+");background-size:24px 24px}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-clear{background-image:url("+B+");background-size:24px 24px}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-undo{background-image:url("+P+")}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-undo.active{background-image:url("+O+");border-color:rgba(0,0,0,0)}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-redo{background-image:url("+k+")}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-redo.active{background-image:url("+x+");border-color:rgba(0,0,0,0)}.cdraw .cdraw-toolbar .cdraw-roll .cdraw-save{background-image:url("+E+");background-size:24px 24px}.cdraw .cdraw-canvas{display:none;margin-top:10px;cursor:crosshair;background:#f5f5f5;transform:translate3d(0, -1000px, 0);transition:all .5s ease-in-out}.cdraw .cdraw-canvas.show{transform:translate3d(0, 0, 0)}",""]);const C=w},645:t=>{"use strict";t.exports=function(t){var e=[];return e.toString=function(){return this.map((function(e){var r="",n=void 0!==e[5];return e[4]&&(r+="@supports (".concat(e[4],") {")),e[2]&&(r+="@media ".concat(e[2]," {")),n&&(r+="@layer".concat(e[5].length>0?" ".concat(e[5]):""," {")),r+=t(e),n&&(r+="}"),e[2]&&(r+="}"),e[4]&&(r+="}"),r})).join("")},e.i=function(t,r,n,o,i){"string"==typeof t&&(t=[[null,t,void 0]]);var a={};if(n)for(var c=0;c<this.length;c++){var s=this[c][0];null!=s&&(a[s]=!0)}for(var u=0;u<t.length;u++){var l=[].concat(t[u]);n&&a[l[0]]||(void 0!==i&&(void 0===l[5]||(l[1]="@layer".concat(l[5].length>0?" ".concat(l[5]):""," {").concat(l[1],"}")),l[5]=i),r&&(l[2]?(l[1]="@media ".concat(l[2]," {").concat(l[1],"}"),l[2]=r):l[2]=r),o&&(l[4]?(l[1]="@supports (".concat(l[4],") {").concat(l[1],"}"),l[4]=o):l[4]="".concat(o)),e.push(l))}},e}},667:t=>{"use strict";t.exports=function(t,e){return e||(e={}),t?(t=String(t.__esModule?t.default:t),/^['"].*['"]$/.test(t)&&(t=t.slice(1,-1)),e.hash&&(t+=e.hash),/["'() \t\n]|(%20)/.test(t)||e.needQuotes?'"'.concat(t.replace(/"/g,'\\"').replace(/\n/g,"\\n"),'"'):t):t}},81:t=>{"use strict";t.exports=function(t){return t[1]}},379:t=>{"use strict";var e=[];function getIndexByIdentifier(t){for(var r=-1,n=0;n<e.length;n++)if(e[n].identifier===t){r=n;break}return r}function modulesToDom(t,r){for(var n={},o=[],i=0;i<t.length;i++){var a=t[i],c=r.base?a[0]+r.base:a[0],s=n[c]||0,u="".concat(c," ").concat(s);n[c]=s+1;var l=getIndexByIdentifier(u),f={css:a[1],media:a[2],sourceMap:a[3],supports:a[4],layer:a[5]};if(-1!==l)e[l].references++,e[l].updater(f);else{var p=addElementStyle(f,r);r.byIndex=i,e.splice(i,0,{identifier:u,updater:p,references:1})}o.push(u)}return o}function addElementStyle(t,e){var r=e.domAPI(e);r.update(t);return function(e){if(e){if(e.css===t.css&&e.media===t.media&&e.sourceMap===t.sourceMap&&e.supports===t.supports&&e.layer===t.layer)return;r.update(t=e)}else r.remove()}}t.exports=function(t,r){var n=modulesToDom(t=t||[],r=r||{});return function(t){t=t||[];for(var o=0;o<n.length;o++){var i=getIndexByIdentifier(n[o]);e[i].references--}for(var a=modulesToDom(t,r),c=0;c<n.length;c++){var s=getIndexByIdentifier(n[c]);0===e[s].references&&(e[s].updater(),e.splice(s,1))}n=a}}},569:t=>{"use strict";var e={};t.exports=function(t,r){var n=function(t){if(void 0===e[t]){var r=document.querySelector(t);if(window.HTMLIFrameElement&&r instanceof window.HTMLIFrameElement)try{r=r.contentDocument.head}catch(t){r=null}e[t]=r}return e[t]}(t);if(!n)throw new Error("Couldn't find a style target. This probably means that the value for the 'insert' parameter is invalid.");n.appendChild(r)}},216:t=>{"use strict";t.exports=function(t){var e=document.createElement("style");return t.setAttributes(e,t.attributes),t.insert(e,t.options),e}},565:(t,e,r)=>{"use strict";t.exports=function(t){var e=r.nc;e&&t.setAttribute("nonce",e)}},795:t=>{"use strict";t.exports=function(t){var e=t.insertStyleElement(t);return{update:function(r){!function(t,e,r){var n="";r.supports&&(n+="@supports (".concat(r.supports,") {")),r.media&&(n+="@media ".concat(r.media," {"));var o=void 0!==r.layer;o&&(n+="@layer".concat(r.layer.length>0?" ".concat(r.layer):""," {")),n+=r.css,o&&(n+="}"),r.media&&(n+="}"),r.supports&&(n+="}");var i=r.sourceMap;i&&"undefined"!=typeof btoa&&(n+="\n/*# sourceMappingURL=data:application/json;base64,".concat(btoa(unescape(encodeURIComponent(JSON.stringify(i))))," */")),e.styleTagTransform(n,t,e.options)}(e,t,r)},remove:function(){!function(t){if(null===t.parentNode)return!1;t.parentNode.removeChild(t)}(e)}}}},589:t=>{"use strict";t.exports=function(t,e){if(e.styleSheet)e.styleSheet.cssText=t;else{for(;e.firstChild;)e.removeChild(e.firstChild);e.appendChild(document.createTextNode(t))}}},378:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg style="transform: scale%28-1,1%29" viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M462.272 163.904l316.736 316.8-361.984 361.984-316.8-316.736L462.272 163.904M417.024 118.656 54.912 480.704c-25.088 25.024-25.088 65.472 0 90.496l316.8 316.736c25.024 25.088 65.408 25.088 90.496 0l361.984-361.984c25.024-25.024 25.024-65.472 0-90.496L507.52 118.656C482.496 93.632 441.984 93.632 417.024 118.656L417.024 118.656zM54.912 571.2l316.8 316.736c25.024 25.088 65.408 25.088 90.496 0l361.984-361.984c12.48-12.48 18.816-28.864 18.752-45.248L54.912 480.704C29.888 505.664 29.888 546.176 54.912 571.2zM145.408 73.344c-12.48 12.544-12.48 32.768 0 45.248L439.616 412.8c12.48 12.48 32.768 12.48 45.248 0l0 0c12.48-12.48 12.48-32.768 0-45.248L190.656 73.344C178.176 60.864 157.952 60.864 145.408 73.344L145.408 73.344zM869.696 525.312c0 0-117.696 181.696-128 256-17.6 126.784 64 141.696 128 141.696s140.48-14.272 128-141.696C990.976 713.024 869.696 525.312 869.696 525.312z"></path></svg>'},105:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M273.6 957.056a25.6 25.6 0 0 1-18.112-7.488l-180.992-180.992a25.6 25.6 0 0 1 0-36.224L798.528 8.256a25.6 25.6 0 0 1 36.224 0l180.992 180.992a25.6 25.6 0 0 1 0 36.224L291.712 949.568a25.6 25.6 0 0 1-18.112 7.488z m-144.832-206.656l144.832 144.832L961.472 207.36 816.64 62.528 128.768 750.4z" p-id="2160"></path><path d="M26.304 1023.296a25.6 25.6 0 0 1-24.768-32.192l66.24-247.296a25.6 25.6 0 0 1 42.816-11.456l180.992 180.992a25.6 25.6 0 0 1-11.456 42.816L32.832 1022.4a26.048 26.048 0 0 1-6.656 0.896z m79.552-223.424l-43.328 161.6 161.6-43.264-118.272-118.336zM736.704 106.24l180.992 180.992-54.336 54.336-180.992-180.992 54.336-54.336zM332.416 653.824a25.6 25.6 0 0 1-18.112-43.712l271.552-271.488a25.6 25.6 0 0 1 36.224 36.224l-271.552 271.488a25.472 25.472 0 0 1-18.112 7.488z"></path></svg>'},157:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M596.676923 248.123077c204.8 0 372.184615 165.415385 372.184615 372.184615s-167.384615 372.184615-372.184615 372.184616h-161.476923c-15.753846 0-25.6-11.815385-25.6-27.569231v-63.015385c0-15.753846 11.815385-29.538462 27.569231-29.538461h159.507692c139.815385 0 252.061538-112.246154 252.061539-252.061539s-112.246154-252.061538-252.061539-252.061538H322.953846s-15.753846 0-21.661538 1.969231c-15.753846 7.876923-11.815385 19.692308 1.96923 33.476923l96.492308 96.492307c11.815385 11.815385 9.846154 29.538462-1.969231 41.353847L354.461538 584.861538c-11.815385 11.815385-25.6 11.815385-37.415384 1.969231l-256-256c-9.846154-9.846154-9.846154-25.6 0-35.446154L315.076923 41.353846c11.815385-11.815385 31.507692-11.815385 41.353846 0l41.353846 41.353846c11.815385 11.815385 11.815385 31.507692 0 41.353846l-96.492307 96.492308c-11.815385 11.815385-11.815385 25.6 7.876923 25.6h13.784615l273.723077 1.969231z" fill="lightgray"></path></svg>'},811:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M596.676923 248.123077c204.8 0 372.184615 165.415385 372.184615 372.184615s-167.384615 372.184615-372.184615 372.184616h-161.476923c-15.753846 0-25.6-11.815385-25.6-27.569231v-63.015385c0-15.753846 11.815385-29.538462 27.569231-29.538461h159.507692c139.815385 0 252.061538-112.246154 252.061539-252.061539s-112.246154-252.061538-252.061539-252.061538H322.953846s-15.753846 0-21.661538 1.969231c-15.753846 7.876923-11.815385 19.692308 1.96923 33.476923l96.492308 96.492307c11.815385 11.815385 9.846154 29.538462-1.969231 41.353847L354.461538 584.861538c-11.815385 11.815385-25.6 11.815385-37.415384 1.969231l-256-256c-9.846154-9.846154-9.846154-25.6 0-35.446154L315.076923 41.353846c11.815385-11.815385 31.507692-11.815385 41.353846 0l41.353846 41.353846c11.815385 11.815385 11.815385 31.507692 0 41.353846l-96.492307 96.492308c-11.815385 11.815385-11.815385 25.6 7.876923 25.6h13.784615l273.723077 1.969231z"></path></svg>'},583:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M699.076923 246.153846h13.784615c19.692308 0 19.692308-13.784615 7.876924-25.6l-96.492308-96.492308c-11.815385-9.846154-11.815385-29.538462 0-41.353846l41.353846-41.353846c9.846154-11.815385 29.538462-11.815385 41.353846 0L960.984615 295.384615c9.846154 9.846154 9.846154 25.6 0 35.446154l-256 256c-11.815385 9.846154-25.6 9.846154-37.415384-1.969231l-43.323077-43.323076c-11.815385-11.815385-13.784615-29.538462-1.969231-41.353847l96.492308-96.492307c13.784615-13.784615 17.723077-25.6 1.969231-33.476923-5.907692-1.969231-21.661538-1.969231-21.661539-1.969231H425.353846c-139.815385 0-252.061538 112.246154-252.061538 252.061538s112.246154 252.061538 252.061538 252.061539h159.507692c15.753846 0 27.569231 13.784615 27.569231 29.538461V964.923077c0 15.753846-9.846154 27.569231-25.6 27.569231h-161.476923C220.553846 992.492308 53.169231 827.076923 53.169231 620.307692s167.384615-372.184615 372.184615-372.184615l273.723077-1.969231z" fill="lightgray"></path></svg>'},413:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M699.076923 246.153846h13.784615c19.692308 0 19.692308-13.784615 7.876924-25.6l-96.492308-96.492308c-11.815385-9.846154-11.815385-29.538462 0-41.353846l41.353846-41.353846c9.846154-11.815385 29.538462-11.815385 41.353846 0L960.984615 295.384615c9.846154 9.846154 9.846154 25.6 0 35.446154l-256 256c-11.815385 9.846154-25.6 9.846154-37.415384-1.969231l-43.323077-43.323076c-11.815385-11.815385-13.784615-29.538462-1.969231-41.353847l96.492308-96.492307c13.784615-13.784615 17.723077-25.6 1.969231-33.476923-5.907692-1.969231-21.661538-1.969231-21.661539-1.969231H425.353846c-139.815385 0-252.061538 112.246154-252.061538 252.061538s112.246154 252.061538 252.061538 252.061539h159.507692c15.753846 0 27.569231 13.784615 27.569231 29.538461V964.923077c0 15.753846-9.846154 27.569231-25.6 27.569231h-161.476923C220.553846 992.492308 53.169231 827.076923 53.169231 620.307692s167.384615-372.184615 372.184615-372.184615l273.723077-1.969231z"></path></svg>'},797:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M829 856H195a4 4 0 0 0-4 4v64a4 4 0 0 0 4 4h634a4 4 0 0 0 4-4v-64a4 4 0 0 0-4-4z m22.2-376H676.6V112a16 16 0 0 0-16-16H363.4a16 16 0 0 0-16 16v368H172.8c-15 0-21.7 18.9-10.1 28.4l339.2 277.3a16 16 0 0 0 20.2 0l339.2-277.3c11.6-9.5 4.9-28.4-10.1-28.4zM512 701L329.8 552h89.6V168h185.2v384h89.6z"></path></svg>'},620:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M899.1 869.6l-53-305.6H864c14.4 0 26-11.6 26-26V346c0-14.4-11.6-26-26-26H618V138c0-14.4-11.6-26-26-26H432c-14.4 0-26 11.6-26 26v182H160c-14.4 0-26 11.6-26 26v192c0 14.4 11.6 26 26 26h17.9l-53 305.6c-0.3 1.5-0.4 3-0.4 4.4 0 14.4 11.6 26 26 26h723c1.5 0 3-0.1 4.4-0.4 14.2-2.4 23.7-15.9 21.2-30zM204 390h272V182h72v208h272v104H204V390z m468 440V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H416V674c0-4.4-3.6-8-8-8h-48c-4.4 0-8 3.6-8 8v156H202.8l45.1-260H776l45.1 260H672z"></path></svg>'},554:t=>{"use strict";t.exports='data:image/svg+xml;utf8,<svg viewBox="0 0 1024 1024" version="1.1" xmlns="http://www.w3.org/2000/svg" width="160" height="160"><path d="M978.817649 939.233112H522.995705l476.613823-476.613823c12.795002-12.795002 20.791878-33.58688 20.791878-55.978133s-7.996876-38.385006-20.791878-55.978134L673.336978 22.791097c-30.38813-30.38813-76.770012-30.38813-107.158142 0L84.766888 504.203046c-110.356892 110.356892-110.356892 294.285045 0 404.641936l30.38813 30.38813c55.978134 55.978134 127.95002 84.766888 204.720031 84.766888h662.141351c25.590004 0 43.183132-17.593128 43.183131-43.183132s-20.791878-41.583756-46.381882-41.583756z m-361.458805-847.668879l315.076923 315.076923-366.256931 366.256931-315.076923-315.076923L617.358844 91.564233zM143.943772 849.668098c-76.770012-76.770012-76.770012-204.720031 0-284.688793l46.381882-46.381882L507.001952 832.074971l-46.381882 46.381882c-38.385006 38.385006-89.565014 59.176884-140.745021 59.176884-55.978134 0-107.158141-20.791878-145.543147-59.176884L143.943772 849.668098z"></path></svg>'}},e={};function __webpack_require__(r){var n=e[r];if(void 0!==n)return n.exports;var o=e[r]={id:r,exports:{}};return t[r](o,o.exports,__webpack_require__),o.exports}__webpack_require__.m=t,__webpack_require__.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return __webpack_require__.d(e,{a:e}),e},__webpack_require__.d=(t,e)=>{for(var r in e)__webpack_require__.o(e,r)&&!__webpack_require__.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},__webpack_require__.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(t){if("object"==typeof window)return window}}(),__webpack_require__.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),__webpack_require__.b=document.baseURI||self.location.href,__webpack_require__.nc=void 0;var r={};return(()=>{"use strict";__webpack_require__.d(r,{default:()=>it});var t=__webpack_require__(379),e=__webpack_require__.n(t),n=__webpack_require__(795),o=__webpack_require__.n(n),i=__webpack_require__(569),a=__webpack_require__.n(i),c=__webpack_require__(565),s=__webpack_require__.n(c),u=__webpack_require__(216),l=__webpack_require__.n(u),f=__webpack_require__(589),p=__webpack_require__.n(f),d=__webpack_require__(653),h={};h.styleTagTransform=p(),h.setAttributes=s(),h.insert=a().bind(null,"head"),h.domAPI=o(),h.insertStyleElement=l();e()(d.Z,h);d.Z&&d.Z.locals&&d.Z.locals;function _typeof(t){return _typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},_typeof(t)}var y=/mobile/i.test(window.navigator.userAgent);const b={isMobile:y,smallScreen:function(){return window.matchMedia("(max-width:768px)").matches},pixelRatio:window.devicePixelRatio,nameMap:{dragStart:y?"touchstart":"mousedown",dragMove:y?"touchmove":"mousemove",dragEnd:y?"touchend":"mouseup"},find:function(t,e){return 1==arguments.length?document.querySelector(t):t.querySelector(e)},insertAfter:function(t,e){var r=t.parentNode;r.lastChild==t?r.appendChild(e):r.insertBefore(e,t.nextElementSibling)},storage:{set:function(t,e){localStorage.setItem(t,e)},get:function(t){return localStorage.getItem(t)}},isObject:function(t){return"object"===_typeof(t)&&null!==t},hsl:function(t,e,r){return"hsl(".concat(t,", ").concat(e,"%, ").concat(r,"%)")}};function _defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}const v=function(){function Events(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Events),this.events={}}var t,e,r;return t=Events,(e=[{key:"bind",value:function(t,e){this.events[t]=this.events[t]||[],this.events[t].push(e)}},{key:"unbind",value:function(t,e){t in this.events!=0&&(e?this.events[t].splice(this.events[t].indexOf(e),1):this.events[t]=[])}},{key:"trigger",value:function(t,e){if(this.events[t]&&this.events[t].length)for(var r=0;r<this.events[t].length;r++)this.events[t][r](e)}}])&&_defineProperties(t.prototype,e),r&&_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),Events}();function history_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var w=function(){function History(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,History),_defineProperty(this,"canUndo",(function(){return this.cur>0})),_defineProperty(this,"canRedo",(function(){return this.cur<this.stack.length-1})),t=t||{},this.maxLength=t.maxLength||30,this.callback=t.callback||function(){},this.stack=[],this.cur=-1}var t,e,r;return t=History,(e=[{key:"first",value:function(){return this.stack[0]}},{key:"current",value:function(){return this.stack[this.cur]}},{key:"clear",value:function(){this.stack=[],this.cur=-1}},{key:"save",value:function(t){this.cur<this.stack.length-1&&this.stack.splice(this.cur+1),this.stack.push(t),this.cur++,this.stack.length>this.maxLength&&(this.stack.shift(),this.cur--),this.callback("save",t)}},{key:"undo",value:function(){return this.cur--,this.callback("undo",this.stack[this.cur]),this.stack[this.cur]}},{key:"redo",value:function(){return this.cur++,this.callback("redo",this.stack[this.cur]),this.stack[this.cur]}}])&&history_defineProperties(t.prototype,e),r&&history_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),History}();const _=w;var m=__webpack_require__(477),g=__webpack_require__.n(m);function template_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var B=function(){function Template(t){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Template),this.options=t;var e=this.getColors();this.html=g()({bows25:e[25],bows50:e[50],bows75:e[75]});var r=(new DOMParser).parseFromString(this.html,"text/html");this.container=b.find(r,".cdraw"),this.commentEle=b.find(this.options.element),b.insertAfter(this.commentEle,this.container),this.getDom(),this.sortEle(),this.scrollBar()}var t,e,r;return t=Template,(e=[{key:"getColors",value:function(){var t={25:[b.hsl(0,0,0)],50:[b.hsl(0,0,59)],75:[b.hsl(0,0,100)]};for(var e in t)for(var r=0;r<360;r+=30){var n=b.hsl(r,100,e);t[e].push(n)}return t}},{key:"getDom",value:function(){this.canvasEle=b.find(this.container,".cdraw-canvas"),this.toolBarEle=b.find(this.container,".cdraw-toolbar"),this.openBtn=b.find(this.container,".cdraw-open"),this.lineColorBtn=b.find(this.container,".cdraw-line-color"),this.lineColorCurrent=b.find(this.lineColorBtn,".current"),this.rainbowsPop=b.find(this.lineColorBtn,".rains"),this.lineWidthBtn=b.find(this.container,".cdraw-line-width"),this.rollGroup=b.find(this.container,".cdraw-roll"),this.brushBtn=b.find(this.container,".cdraw-brush"),this.eraserBtn=b.find(this.container,".cdraw-eraser"),this.bucketBtn=b.find(this.container,".cdraw-bucket"),this.clearBtn=b.find(this.container,".cdraw-clear"),this.undoBtn=b.find(this.container,".cdraw-undo"),this.redoBtn=b.find(this.container,".cdraw-redo"),this.saveBtn=b.find(this.container,".cdraw-save")}},{key:"sortEle",value:function(){var t=this,e={open:this.openBtn,lineColor:this.lineColorBtn,lineWidth:this.lineWidthBtn},r={brush:this.brushBtn,eraser:this.eraserBtn,bucket:this.bucketBtn,clear:this.clearBtn,undo:this.undoBtn,redo:this.redoBtn,save:this.saveBtn};this.toolBarEle.innerHTML="",this.options.controls.forEach((function(r,n){e[r]&&t.toolBarEle.appendChild(e[r])})),this.rollGroup.innerHTML="",this.options.controls.forEach((function(e,n){r[e]&&t.rollGroup.appendChild(r[e])})),this.toolBarEle.appendChild(this.rollGroup)}},{key:"scrollBar",value:function(){var t,e,r,n=this.rollGroup,o=!1;n.addEventListener("mousedown",(function(e){e.preventDefault(),o=!0,(new Date).getTime(),n.classList.add("active"),t=e.pageX-n.offsetLeft,r=n.scrollLeft})),n.addEventListener("mousemove",(function(i){o&&(i.preventDefault(),e=i.pageX-n.offsetLeft,n.scrollLeft=r-(e-t))})),n.addEventListener("mouseup",(function(){o=!1,(new Date).getTime(),n.classList.remove("active")})),n.addEventListener("mouseleave",(function(){o=!1,n.classList.remove("active")})),n.addEventListener("click",(function(t){}));var scrolling=function(){n.scrollWidth>n.clientWidth?n.classList.contains("scroll")||n.classList.add("scroll"):n.classList.contains("scroll")&&n.classList.remove("scroll")};scrolling(),window.addEventListener("resize",scrolling)}}])&&template_defineProperties(t.prototype,e),r&&template_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),Template}();const P=B;function controller_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var O=function(){function Controller(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Controller),(this instanceof Controller?this.constructor:void 0)===Controller)throw new Error("Controller cannot be directly instantiated");if(!this.init)throw new Error("Inheriting class must define init()");if(!this.onBoardReset)throw new Error("Inheriting class must define onBoardReset()");this.initing=!0,this.board=t,this.init(),this.add2Board(),this.board.ev.bind("board:reset",this.onBoardReset()),this.initing=!1}var t,e,r;return t=Controller,(e=[{key:"add2Board",value:function(){this.board.addController(this)}},{key:"btnChange",value:function(){var t=this;return function(e){t===e?t.btn.classList.contains("active")||t.btn.classList.add("active"):t.btn.classList.contains("active")&&t.btn.classList.remove("active")}}}])&&controller_defineProperties(t.prototype,e),r&&controller_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),Controller}();const k=O;function simpleReactive_typeof(t){return simpleReactive_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},simpleReactive_typeof(t)}var x=new Map,E=new Map,C=null;function effect(t){try{return C=t,t()}finally{C=null}}var S={get:function(t,e,r){!function(t,e,r){if(null!=C){var n=x.get(t);n||x.set(t,n=new Map);var o=n.get(r);o||(o=new Set),!o.has(C)&&C&&o.add(C),n.set(r,o)}}(t,0,e);var n=Reflect.get(t,e,r);return b.isObject(n)?reactive(n):n},set:function(t,e,r,n){var o=Reflect.set(t,e,r,n);return function(t,e,r){var n=x.get(t);if(n){var o=n.get(r);o&&o.forEach((function(t){t()}))}}(t,0,e),o}};function reactive(t){if("object"!==simpleReactive_typeof(t))return t;var e=E.get(t);if(e)return e;var r=new Proxy(t,S);return E.set(t,r),r}function openBtn_typeof(t){return openBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},openBtn_typeof(t)}function openBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function _setPrototypeOf(t,e){return _setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},_setPrototypeOf(t,e)}function _createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=_getPrototypeOf(t);if(e){var o=_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return _possibleConstructorReturn(this,r)}}function _possibleConstructorReturn(t,e){if(e&&("object"===openBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function _getPrototypeOf(t){return _getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},_getPrototypeOf(t)}var j=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_setPrototypeOf(t,e)}(OpenBtn,t);var e,r,n,o=_createSuper(OpenBtn);function OpenBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,OpenBtn),o.call(this,t)}return e=OpenBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.openBtn,this.ret=reactive({show:!1}),this.btn.addEventListener("click",(function(){t.ret.show=!t.ret.show})),this.reactiveUI()}},{key:"onBoardReset",value:function(){return function(){}}},{key:"reactiveUI",value:function(){var t=this;effect((function(){t.ret.show?(b.smallScreen()?t.btn.innerHTML="关闭":t.btn.innerHTML="关闭画板",t.board.options.readOnlyMode&&(t.board.template.commentEle.readOnly=!0),t.board.updateEditor(),t.board.template.canvasEle.style.display="block",setTimeout((function(){t.board.template.canvasEle.classList.add("show")}),100)):(b.smallScreen()?t.btn.innerHTML="打开":t.btn.innerHTML="打开画板",t.board.options.readOnlyMode&&(t.board.template.commentEle.readOnly=!1),t.initing||t.board._removeEditorImage(),t.board.template.canvasEle.classList.remove("show"),setTimeout((function(){t.board.template.canvasEle.style.display="none"}),450))}))}}])&&openBtn_defineProperties(e.prototype,r),n&&openBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),OpenBtn}(k);const R=j;function brushBtn_typeof(t){return brushBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},brushBtn_typeof(t)}function brushBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function brushBtn_setPrototypeOf(t,e){return brushBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},brushBtn_setPrototypeOf(t,e)}function brushBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=brushBtn_getPrototypeOf(t);if(e){var o=brushBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return brushBtn_possibleConstructorReturn(this,r)}}function brushBtn_possibleConstructorReturn(t,e){if(e&&("object"===brushBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function brushBtn_getPrototypeOf(t){return brushBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},brushBtn_getPrototypeOf(t)}var L=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&brushBtn_setPrototypeOf(t,e)}(BrushBtn,t);var e,r,n,o=brushBtn_createSuper(BrushBtn);function BrushBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,BrushBtn),o.call(this,t)}return e=BrushBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.brushBtn,this.btn.addEventListener("click",(function(){t.board.setShape(t.board.shapes.Sketch),t.board.ev.trigger("btn:change",t)})),this.board.ev.bind("btn:change",this.btnChange())}},{key:"onBoardReset",value:function(){var t=this;return function(){t.btn.click()}}}])&&brushBtn_defineProperties(e.prototype,r),n&&brushBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),BrushBtn}(k);const D=L;function bucketBtn_typeof(t){return bucketBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bucketBtn_typeof(t)}function bucketBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bucketBtn_setPrototypeOf(t,e){return bucketBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bucketBtn_setPrototypeOf(t,e)}function bucketBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bucketBtn_getPrototypeOf(t);if(e){var o=bucketBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return bucketBtn_possibleConstructorReturn(this,r)}}function bucketBtn_possibleConstructorReturn(t,e){if(e&&("object"===bucketBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bucketBtn_getPrototypeOf(t){return bucketBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bucketBtn_getPrototypeOf(t)}var T=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bucketBtn_setPrototypeOf(t,e)}(BucketBtn,t);var e,r,n,o=bucketBtn_createSuper(BucketBtn);function BucketBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,BucketBtn),o.call(this,t)}return e=BucketBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.bucketBtn,this.btn.addEventListener("click",(function(){t.board.setShape(t.board.shapes.Bucket),t.board.ev.trigger("btn:change",t)})),this.board.ev.bind("btn:change",this.btnChange())}},{key:"onBoardReset",value:function(){return function(){}}}])&&bucketBtn_defineProperties(e.prototype,r),n&&bucketBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),BucketBtn}(k);const I=T;function shape_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var W=function(){function Shape(t){if(function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Shape),(this instanceof Shape?this.constructor:void 0)===Shape)throw new Error("Shape cannot be directly instantiated");if(!this.init)throw new Error("Inheriting class must define init()");if(!this.startDraw)throw new Error("Inheriting class must define startDraw()");if(!this.drawing)throw new Error("Inheriting class must define drawing()");if(!this.endDraw)throw new Error("Inheriting class must define endDraw()");this.board=t,this.context=this.board.context,this.canvasEle=this.board.template.canvasEle,this.init(),this.add2Board()}var t,e,r;return t=Shape,(e=[{key:"add2Board",value:function(){this.board.addShape(this)}}])&&shape_defineProperties(t.prototype,e),r&&shape_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),Shape}();const M=W;function eraser_typeof(t){return eraser_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eraser_typeof(t)}function eraser_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eraser_setPrototypeOf(t,e){return eraser_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},eraser_setPrototypeOf(t,e)}function eraser_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=eraser_getPrototypeOf(t);if(e){var o=eraser_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return eraser_possibleConstructorReturn(this,r)}}function eraser_possibleConstructorReturn(t,e){if(e&&("object"===eraser_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function eraser_getPrototypeOf(t){return eraser_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eraser_getPrototypeOf(t)}var H=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eraser_setPrototypeOf(t,e)}(Eraser,t);var e,r,n,o=eraser_createSuper(Eraser);function Eraser(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Eraser),o.call(this,t)}return e=Eraser,(r=[{key:"init",value:function(){this.name=this.constructor.name}},{key:"startDraw",value:function(){this._erasePoint(this.board.lastPoint.x,this.board.lastPoint.y)}},{key:"drawing",value:function(){this._erasePoint(this.board.lastPoint.x,this.board.lastPoint.y),this._drawEraser(this.board.endPoint.x,this.board.endPoint.y)}},{key:"endDraw",value:function(){return this._erasePoint(this.board.lastPoint.x,this.board.lastPoint.y),!0}},{key:"_erasePoint",value:function(t,e){var r=this.board.lineWidth;this.context.save(),this.context.beginPath(),this.context.arc(t,e,r/2+1,0,2*Math.PI),this.context.clip(),this.context.clearRect(0,0,this.canvasEle.width,this.canvasEle.height),this.context.restore()}},{key:"_drawEraser",value:function(t,e){var r=this.board.lineWidth,n=5*b.pixelRatio;this.context.save(),this.context.lineWidth=n,this.context.strokeStyle="rgb(252,150,148)",this.context.beginPath(),this.context.arc(t,e,r/2,0,2*Math.PI),this.context.clip(),this.context.stroke(),this.context.restore()}}])&&eraser_defineProperties(e.prototype,r),n&&eraser_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),Eraser}(M);const U=H;function eraserBtn_typeof(t){return eraserBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},eraserBtn_typeof(t)}function eraserBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function eraserBtn_setPrototypeOf(t,e){return eraserBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},eraserBtn_setPrototypeOf(t,e)}function eraserBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=eraserBtn_getPrototypeOf(t);if(e){var o=eraserBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return eraserBtn_possibleConstructorReturn(this,r)}}function eraserBtn_possibleConstructorReturn(t,e){if(e&&("object"===eraserBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function eraserBtn_getPrototypeOf(t){return eraserBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},eraserBtn_getPrototypeOf(t)}var z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&eraserBtn_setPrototypeOf(t,e)}(EraserBtn,t);var e,r,n,o=eraserBtn_createSuper(EraserBtn);function EraserBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,EraserBtn),o.call(this,t)}return e=EraserBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.eraserBtn,this.btn.addEventListener("click",(function(){t.board.setShape(t.board.shapes.Eraser),t.board.ev.trigger("btn:change",t)})),this.board.ev.bind("btn:change",this.btnChange())}},{key:"onBoardReset",value:function(){return function(){}}}])&&eraserBtn_defineProperties(e.prototype,r),n&&eraserBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),EraserBtn}(k);const q=z;function lineWidthBtn_typeof(t){return lineWidthBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lineWidthBtn_typeof(t)}function lineWidthBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lineWidthBtn_setPrototypeOf(t,e){return lineWidthBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lineWidthBtn_setPrototypeOf(t,e)}function lineWidthBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=lineWidthBtn_getPrototypeOf(t);if(e){var o=lineWidthBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return lineWidthBtn_possibleConstructorReturn(this,r)}}function lineWidthBtn_possibleConstructorReturn(t,e){if(e&&("object"===lineWidthBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function lineWidthBtn_getPrototypeOf(t){return lineWidthBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lineWidthBtn_getPrototypeOf(t)}var F=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lineWidthBtn_setPrototypeOf(t,e)}(LineWidthBtn,t);var e,r,n,o=lineWidthBtn_createSuper(LineWidthBtn);function LineWidthBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,LineWidthBtn),o.call(this,t)}return e=LineWidthBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.lineWidthBtn=this.board.template.lineWidthBtn,this.ret=reactive({width:0}),this.lineWidthBtn.addEventListener("input",(function(){t.ret.width=parseInt(t.lineWidthBtn.value*b.pixelRatio)})),this.reactiveUI()}},{key:"onBoardReset",value:function(){var t=this;return function(){t.lineWidthBtn.value=8,t.ret.width=parseInt(t.lineWidthBtn.value*b.pixelRatio)}}},{key:"reactiveUI",value:function(){var t=this;effect((function(){t.board.lineWidth=t.ret.width}))}}])&&lineWidthBtn_defineProperties(e.prototype,r),n&&lineWidthBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),LineWidthBtn}(k);const A=F;function clearBtn_typeof(t){return clearBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},clearBtn_typeof(t)}function clearBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function clearBtn_setPrototypeOf(t,e){return clearBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},clearBtn_setPrototypeOf(t,e)}function clearBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=clearBtn_getPrototypeOf(t);if(e){var o=clearBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return clearBtn_possibleConstructorReturn(this,r)}}function clearBtn_possibleConstructorReturn(t,e){if(e&&("object"===clearBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function clearBtn_getPrototypeOf(t){return clearBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},clearBtn_getPrototypeOf(t)}var V=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&clearBtn_setPrototypeOf(t,e)}(ClearBtn,t);var e,r,n,o=clearBtn_createSuper(ClearBtn);function ClearBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,ClearBtn),o.call(this,t)}return e=ClearBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.clearBtn,this.btn.addEventListener("click",(function(){t.board._clear(),t.board.history.clear(),t.board.saveHistory()}))}},{key:"onBoardReset",value:function(){return function(){}}}])&&clearBtn_defineProperties(e.prototype,r),n&&clearBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),ClearBtn}(k);const N=V;function lineColorBtn_typeof(t){return lineColorBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},lineColorBtn_typeof(t)}function lineColorBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function lineColorBtn_setPrototypeOf(t,e){return lineColorBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},lineColorBtn_setPrototypeOf(t,e)}function lineColorBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=lineColorBtn_getPrototypeOf(t);if(e){var o=lineColorBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return lineColorBtn_possibleConstructorReturn(this,r)}}function lineColorBtn_possibleConstructorReturn(t,e){if(e&&("object"===lineColorBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function lineColorBtn_getPrototypeOf(t){return lineColorBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},lineColorBtn_getPrototypeOf(t)}var $=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&lineColorBtn_setPrototypeOf(t,e)}(LineColorBtn,t);var e,r,n,o=lineColorBtn_createSuper(LineColorBtn);function LineColorBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,LineColorBtn),o.call(this,t)}return e=LineColorBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.lineColorBtn,this.rainbowsPop=this.board.template.rainbowsPop,this.lineColorCurrent=this.board.template.lineColorCurrent,this.ret=reactive({show:!1}),this.btn.addEventListener("click",(function(e){e.target.classList.contains("color")&&(t.board.lineColor=e.target.dataset.color,t.lineColorCurrent.setAttribute("style","background-color: "+e.target.dataset.color+";")),t.ret.show=!t.ret.show})),document.addEventListener("click",(function(e){t.ret.show&&(t.btn.contains(e.target)||(t.ret.show=!1))})),this.reactiveUI()}},{key:"onBoardReset",value:function(){var t=this;return function(){b.find(t.rainbowsPop,'div[data-color="hsl(210, 100%, 50%)"]').click(),t.ret.show=!1}}},{key:"reactiveUI",value:function(){var t=this;effect((function(){t.ret.show?t.rainbowsPop.style.display="block":t.rainbowsPop.style.display="none"}))}}])&&lineColorBtn_defineProperties(e.prototype,r),n&&lineColorBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),LineColorBtn}(k);const G=$;function undoBtn_typeof(t){return undoBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},undoBtn_typeof(t)}function undoBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function undoBtn_setPrototypeOf(t,e){return undoBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},undoBtn_setPrototypeOf(t,e)}function undoBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=undoBtn_getPrototypeOf(t);if(e){var o=undoBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return undoBtn_possibleConstructorReturn(this,r)}}function undoBtn_possibleConstructorReturn(t,e){if(e&&("object"===undoBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function undoBtn_getPrototypeOf(t){return undoBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},undoBtn_getPrototypeOf(t)}var Z=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&undoBtn_setPrototypeOf(t,e)}(UndoBtn,t);var e,r,n,o=undoBtn_createSuper(UndoBtn);function UndoBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,UndoBtn),o.call(this,t)}return e=UndoBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.undoBtn,this.ret=reactive({active:!1}),this.btn.addEventListener("click",(function(){t.ret.active&&t.board._setImage(t.board.history.undo())})),this.reactiveUI(),this.board.ev.bind("board:history",this.updateUIData())}},{key:"onBoardReset",value:function(){var t=this;return function(){t.updateUIData()()}}},{key:"updateUIData",value:function(){var t=this;return function(){t.board.history.canUndo()?t.ret.active=!0:t.ret.active=!1}}},{key:"reactiveUI",value:function(){var t=this;effect((function(){t.ret.active?t.btn.classList.contains("active")||t.btn.classList.add("active"):t.btn.classList.contains("active")&&t.btn.classList.remove("active")}))}}])&&undoBtn_defineProperties(e.prototype,r),n&&undoBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),UndoBtn}(k);const X=Z;function redoBtn_typeof(t){return redoBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},redoBtn_typeof(t)}function redoBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function redoBtn_setPrototypeOf(t,e){return redoBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},redoBtn_setPrototypeOf(t,e)}function redoBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=redoBtn_getPrototypeOf(t);if(e){var o=redoBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return redoBtn_possibleConstructorReturn(this,r)}}function redoBtn_possibleConstructorReturn(t,e){if(e&&("object"===redoBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function redoBtn_getPrototypeOf(t){return redoBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},redoBtn_getPrototypeOf(t)}var J=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&redoBtn_setPrototypeOf(t,e)}(RedoBtn,t);var e,r,n,o=redoBtn_createSuper(RedoBtn);function RedoBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,RedoBtn),o.call(this,t)}return e=RedoBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.redoBtn,this.ret=reactive({active:!1}),this.btn.addEventListener("click",(function(){t.ret.active&&t.board._setImage(t.board.history.redo())})),this.reactiveUI(),this.board.ev.bind("board:history",this.updateUIData())}},{key:"onBoardReset",value:function(){var t=this;return function(){t.updateUIData()()}}},{key:"updateUIData",value:function(){var t=this;return function(){t.board.history.canRedo()?t.ret.active=!0:t.ret.active=!1}}},{key:"reactiveUI",value:function(){var t=this;effect((function(){t.ret.active?t.btn.classList.contains("active")||t.btn.classList.add("active"):t.btn.classList.contains("active")&&t.btn.classList.remove("active")}))}}])&&redoBtn_defineProperties(e.prototype,r),n&&redoBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),RedoBtn}(k);const Q=J;function saveBtn_typeof(t){return saveBtn_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},saveBtn_typeof(t)}function saveBtn_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function saveBtn_setPrototypeOf(t,e){return saveBtn_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},saveBtn_setPrototypeOf(t,e)}function saveBtn_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=saveBtn_getPrototypeOf(t);if(e){var o=saveBtn_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return saveBtn_possibleConstructorReturn(this,r)}}function saveBtn_possibleConstructorReturn(t,e){if(e&&("object"===saveBtn_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function saveBtn_getPrototypeOf(t){return saveBtn_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},saveBtn_getPrototypeOf(t)}var Y=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&saveBtn_setPrototypeOf(t,e)}(SaveBtn,t);var e,r,n,o=saveBtn_createSuper(SaveBtn);function SaveBtn(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,SaveBtn),o.call(this,t)}return e=SaveBtn,(r=[{key:"init",value:function(){var t=this;this.name=this.constructor.name,this.btn=this.board.template.saveBtn,this.btn.addEventListener("click",(function(){var e=t.board._getImage(),r=document.createElement("a");document.body.appendChild(r),r.href=e,r.download="cave-draw-"+(new Date).getTime(),r.target="_blank",r.click()}))}},{key:"onBoardReset",value:function(){return function(){}}}])&&saveBtn_defineProperties(e.prototype,r),n&&saveBtn_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),SaveBtn}(k);const K=Y;function sketch_typeof(t){return sketch_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},sketch_typeof(t)}function sketch_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function sketch_setPrototypeOf(t,e){return sketch_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},sketch_setPrototypeOf(t,e)}function sketch_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=sketch_getPrototypeOf(t);if(e){var o=sketch_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return sketch_possibleConstructorReturn(this,r)}}function sketch_possibleConstructorReturn(t,e){if(e&&("object"===sketch_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function sketch_getPrototypeOf(t){return sketch_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},sketch_getPrototypeOf(t)}var tt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&sketch_setPrototypeOf(t,e)}(Sketch,t);var e,r,n,o=sketch_createSuper(Sketch);function Sketch(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Sketch),o.call(this,t)}return e=Sketch,(r=[{key:"init",value:function(){this.name=this.constructor.name}},{key:"startDraw",value:function(){this._line(this.board.startPoint,this.board.startPoint)}},{key:"drawing",value:function(){this._line(this.board.lastPoint,this.board.endPoint)}},{key:"endDraw",value:function(){return!0}},{key:"_line",value:function(t,e){this.context.beginPath(),this.context.lineWidth=this.board.lineWidth,this.context.strokeStyle=this.board.lineColor,this.context.moveTo(t.x,t.y),this.context.lineTo(e.x,e.y),this.context.stroke()}}])&&sketch_defineProperties(e.prototype,r),n&&sketch_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),Sketch}(M);const et=tt;function bucket_typeof(t){return bucket_typeof="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},bucket_typeof(t)}function bucket_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function bucket_setPrototypeOf(t,e){return bucket_setPrototypeOf=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t},bucket_setPrototypeOf(t,e)}function bucket_createSuper(t){var e=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var r,n=bucket_getPrototypeOf(t);if(e){var o=bucket_getPrototypeOf(this).constructor;r=Reflect.construct(n,arguments,o)}else r=n.apply(this,arguments);return bucket_possibleConstructorReturn(this,r)}}function bucket_possibleConstructorReturn(t,e){if(e&&("object"===bucket_typeof(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return function(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}(t)}function bucket_getPrototypeOf(t){return bucket_getPrototypeOf=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)},bucket_getPrototypeOf(t)}var rt=function(t){!function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&bucket_setPrototypeOf(t,e)}(Bucket,t);var e,r,n,o=bucket_createSuper(Bucket);function Bucket(t){return function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Bucket),o.call(this,t)}return e=Bucket,(r=[{key:"init",value:function(){this.name=this.constructor.name,this.offscreenCanvas=document.createElement("canvas"),this.offscreenCanvas.width=1,this.offscreenCanvas.height=1,this.offscreenContext=this.offscreenCanvas.getContext("2d"),this.clickColor,this.bucketColor,this.changed=!1}},{key:"startDraw",value:function(){if(this.changed=!1,this.board._getImage()===this.board.history.first())return this.context.clearRect(0,0,this.canvasEle.width,this.canvasEle.height),this.context.fillStyle=this.board.lineColor,this.context.fillRect(0,0,this.canvasEle.width,this.canvasEle.height),void(this.changed=!0);var t=this.context.getImageData(0,0,this.canvasEle.width,this.canvasEle.height),e={x:parseInt(this.board.startPoint.x),y:parseInt(this.board.startPoint.y)};this.clickColor=this._rgbFromImageDataWithPixel(t,e.x,e.y),this.bucketColor=this._2rgb(this.board.lineColor);var r=[];r.push(e),this._floodFillWithQueue(t,r,this.bucketColor,this.clickColor),this.context.putImageData(t,0,0),this._compareColor(this.clickColor,this.bucketColor)?this.changed=!1:this.changed=!0}},{key:"drawing",value:function(){}},{key:"endDraw",value:function(){return this.changed}},{key:"_rgbFromImageData",value:function(t,e){return{r:t.data[e],g:t.data[e+1],b:t.data[e+2],a:t.data[e+3]}}},{key:"_rgbFromImageDataWithPixel",value:function(t,e,r){var n=4*(r*t.width+e);return this._rgbFromImageData(t,n)}},{key:"_2rgb",value:function(t){this.offscreenContext.fillStyle=t,this.offscreenContext.fillRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height);var e=this.offscreenContext.getImageData(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height);return this._rgbFromImageData(e,0)}},{key:"_setColor4ImageDataWithPixel",value:function(t,e,r,n){var o=4*(r*t.width+e);t.data[o]=n.r,t.data[o+1]=n.g,t.data[o+2]=n.b,t.data[o+3]=n.a}},{key:"_compareColor",value:function(t,e){return t.r==e.r&&t.g==e.g&&t.b==e.b&&t.a==e.a}},{key:"_floodFillWithQueue",value:function(t,e,r,n){for(var o,i;i=e.pop();)o=this._rgbFromImageDataWithPixel(t,i.x,i.y),this._compareColor(o,n)&&!this._compareColor(o,r)&&(this._setColor4ImageDataWithPixel(t,i.x,i.y,r),i.x>0&&e.push({x:i.x-1,y:i.y}),i.x<t.width-1&&e.push({x:i.x+1,y:i.y}),i.y>0&&e.push({x:i.x,y:i.y-1}),i.y<t.height-1&&e.push({x:i.x,y:i.y+1}))}},{key:"_floodFill",value:function(t,e,r,n,o){if(e>0&&e<t.width&&r>0&&r<t.height){var i=this._rgbFromImageDataWithPixel(t,e,r);this._compareColor(i,o)&&!this._compareColor(i,n)&&(this._setColor4ImageDataWithPixel(t,e,r,n),this._floodFill(t,e+1,r,n,o),this._floodFill(t,e-1,r,n,o),this._floodFill(t,e,r+1,n,o),this._floodFill(t,e,r-1,n,o))}}}])&&bucket_defineProperties(e.prototype,r),n&&bucket_defineProperties(e,n),Object.defineProperty(e,"prototype",{writable:!1}),Bucket}(M);const nt=rt;function board_defineProperties(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function board_defineProperty(t,e,r){return e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}var ot=function(){function Board(t){var e=this;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,Board),board_defineProperty(this,"saveHistory2Disk",(function(){e.history.cur>0&&b.storage.set(e.options.appName+"-image",e.history.current())})),board_defineProperty(this,"updateEditor",(function(){if(e.controllers.OpenBtn.ret.show){var t=e.history.current();e._updateEditor()(t)}})),board_defineProperty(this,"_updateEditor",(function(t){var e=this;return function(t){var r='<img data-type="cdraw" src="'.concat(t,'" />'),n=/\<img data-type="cdraw".*\>/g;n.test(e.template.commentEle.value)?e.template.commentEle.value=e.template.commentEle.value.replace(n,r):""==e.template.commentEle.value?e.template.commentEle.value=r:/\n$/.test(e.template.commentEle.value)?e.template.commentEle.value=e.template.commentEle.value+r:e.template.commentEle.value=e.template.commentEle.value+"\n"+r,e.options.afterUpdateEditor()}})),this.ev=new v,this.history=new _({maxLength:30,callback:function(t,r){e.ev.trigger("board:history")}}),this.ev.bind("board:history",this.saveHistory2Disk),this.ev.bind("board:history",this.updateEditor),this.options=function(t){var e={appName:"cave-draw",minCanvasHeight:300,element:"",readOnlyMode:!0,afterUpdateEditor:function(){},controls:["brush","eraser","clear"]};for(var r in e)t.hasOwnProperty(r)||(t[r]=e[r]);return t.controls.unshift("open","lineColor","lineWidth"),t}(t),b.find(this.options.element)&&(this.template=new P(this.options),this.controllers=[],this.initControllers(),this.initCanvasContext(),this.initCanvasSize(),this.shapes=[],this.initShapes(),this.setShape(this.shapes.Sketch),this.initDrawEvents(),this.saveHistory(),this.restoreHistoryFromDisk(),this.ev.trigger("board:reset"))}var t,e,r;return t=Board,e=[{key:"initControllers",value:function(){var t=this,e={open:R,lineColor:G,lineWidth:A,brush:D,eraser:q,bucket:I,clear:N,undo:X,redo:Q,save:K};this.options.controls.forEach((function(r,n){e[r]&&new e[r](t)}))}},{key:"initCanvasStyle",value:function(){this.context.lineCap="round",this.context.lineJoin="round"}},{key:"initCanvasContext",value:function(){this.context=this.template.canvasEle.getContext("2d"),this.lineWidth=0,this.lineColor="black",this.initCanvasStyle()}},{key:"initCanvasSize",value:function(){var t=this,canvasResize=function(){var e=t.context.getImageData(0,0,t.template.canvasEle.width,t.template.canvasEle.height),r=t.template.commentEle.offsetWidth,n=t.template.commentEle.offsetWidth/3<t.options.minCanvasHeight?t.options.minCanvasHeight:t.template.commentEle.offsetWidth/3;t.template.canvasEle.width=r*b.pixelRatio,t.template.canvasEle.height=n*b.pixelRatio,t.context.putImageData(e,0,0),t.template.canvasEle.style.width=r+"px",t.template.canvasEle.style.height=n+"px",t.initCanvasStyle()};canvasResize(),window.addEventListener("resize",canvasResize),ResizeObserver&&new ResizeObserver((function(t){canvasResize()})).observe(this.template.commentEle)}},{key:"initShapes",value:function(){var t=this;[et,nt,U].forEach((function(e,r){new e(t)}))}},{key:"initDrawEvents",value:function(){var t=this;this.startPoint={x:void 0,y:void 0},this.lastPoint={x:void 0,y:void 0},this.endPoint={x:void 0,y:void 0};var e=!1;this.template.canvasEle.addEventListener(b.nameMap.dragStart,(function(r){r.preventDefault(),e=!0,t.startPoint=t._getPoint(r),t.lastPoint=t.startPoint,t.shape.startDraw()})),this.template.canvasEle.addEventListener(b.nameMap.dragMove,(function(r){r.preventDefault(),e&&(t.endPoint=t._getPoint(r),b.isMobile&&t._outCanvas(t.endPoint)?(e=!1,t.shape.endDraw()&&t.drawDone()):(t.shape.drawing(),t.lastPoint=t.endPoint))})),this.template.canvasEle.addEventListener(b.nameMap.dragEnd,(function(r){r.preventDefault(),e&&(e=!1,t.shape.endDraw()&&t.drawDone())})),this.template.canvasEle.addEventListener("mouseout",(function(r){r.preventDefault(),e&&(e=!1,t.shape.endDraw()&&t.drawDone())}))}},{key:"setShape",value:function(t){this.shape=t}},{key:"saveHistory",value:function(){this.history.save(this._getImage())}},{key:"drawDone",value:function(){this.saveHistory()}},{key:"restoreHistoryFromDisk",value:function(){var t=this,e=b.storage.get(this.options.appName+"-image");if(e){var r=new Image;r.onload=function(){t.context.clearRect(0,0,t.template.canvasEle.width,t.template.canvasEle.height),t.context.drawImage(r,0,0),t.saveHistory()},r.src=e}}},{key:"addController",value:function(t){var e=t.name;this.controllers.forEach((function(t){if(e==t.name)throw new Error(" 已经有 ".concat(e," 在 controllers 中了 "))})),this.controllers.push(t),this.controllers[e]=t}},{key:"addShape",value:function(t){var e=t.name;this.shapes.forEach((function(t){if(e==t.name)throw new Error(" 已经有 ".concat(e," 在 shapes 中了 "))})),this.shapes.push(t),this.shapes[e]=t}},{key:"_getPoint",value:function(t){return b.isMobile?{x:(t.touches[0].clientX-this.template.canvasEle.getBoundingClientRect().left)*b.pixelRatio,y:(t.touches[0].clientY-this.template.canvasEle.getBoundingClientRect().top)*b.pixelRatio}:{x:t.offsetX*b.pixelRatio,y:t.offsetY*b.pixelRatio}}},{key:"_outCanvas",value:function(t){return!(t.x>0&&t.x<this.template.canvasEle.width&&t.y>0&&t.y<this.template.canvasEle.height)}},{key:"_getImage",value:function(){return this.template.canvasEle.toDataURL("image/png")}},{key:"_getImageBlob",value:function(t){this.template.canvasEle.toBlob((function(e){var r=URL.createObjectURL(e);t&&t(r)}),"image/png")}},{key:"_setImage",value:function(t){var e=this,r=new Image;r.onload=function(){e.context.clearRect(0,0,e.template.canvasEle.width,e.template.canvasEle.height),e.context.drawImage(r,0,0)},r.src=t}},{key:"_clear",value:function(){this.context.clearRect(0,0,this.template.canvasEle.width,this.template.canvasEle.height)}},{key:"_removeEditorImage",value:function(){var t=/\<img data-type="cdraw".*\>/g;t.test(this.template.commentEle.value)&&(this.template.commentEle.value=this.template.commentEle.value.replace(t,"")),this.options.afterUpdateEditor()}}],e&&board_defineProperties(t.prototype,e),r&&board_defineProperties(t,r),Object.defineProperty(t,"prototype",{writable:!1}),Board}();const it=ot})(),r=r.default})()));